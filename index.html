<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"/>
<title>时间胶囊日历</title>

<!-- -------- 样式：渐变 + 玻璃 + 动效 -------- -->
<style>
:root{
  --bg:radial-gradient(circle at 25% 30%,#ffd8e5 0%,#ffeef3 40%,#ffffff 100%);
  --glass:rgba(255,255,255,.55);
  --shadow:0 24px 36px rgba(0,0,0,.12);
  --radius:18px;
  --primary:#ff6f91;
  --accent:#ffb3c6;
  font-size:16px;
}
*{box-sizing:border-box;margin:0;padding:0;-webkit-tap-highlight-color:transparent;font-family:-apple-system,BlinkMacSystemFont,"PingFang SC","Microsoft YaHei",sans-serif;}
body{min-height:100vh;background:var(--bg);display:flex;flex-direction:column;gap:18px;padding:24px;animation:bgMove 30s infinite alternate ease-out;}
@keyframes bgMove{from{background-position:0 0;}to{background-position:120% 80%;}}
h1{font-size:1.6rem;font-weight:700;text-align:center;letter-spacing:.6px;color:var(--primary);text-shadow:0 3px 6px rgba(255,255,255,.6);}
.header{display:flex;justify-content:space-between;align-items:center;margin-top:4px;}
.btn-nav{width:44px;height:44px;border:none;background:none;color:var(--primary);font-size:1.6rem;cursor:pointer;transition:.25s;border-radius:50%;}
.btn-nav:hover{background:rgba(255,255,255,.3);backdrop-filter:blur(6px);}
.calendar{display:grid;grid-template-columns:repeat(7,1fr);gap:8px;margin-top:6px;user-select:none;}
.weekday,.day{aspect-ratio:1/1;border-radius:var(--radius);display:flex;align-items:center;justify-content:center;font-weight:600;position:relative;backdrop-filter:blur(8px);-webkit-backdrop-filter:blur(8px);}
.weekday{background:var(--glass);color:#555;}
.day{background:var(--glass);color:#444;font-weight:500;box-shadow:0 4px 8px rgba(0,0,0,.06);cursor:pointer;transition:.3s;}
.day:hover{transform:translateY(-2px);box-shadow:0 6px 12px rgba(0,0,0,.08);}
.day.has::after{content:"✨";position:absolute;bottom:6px;right:6px;font-size:.8rem;}
.day.sel{outline:3px solid var(--primary);}
.card{background:var(--glass);backdrop-filter:blur(12px);-webkit-backdrop-filter:blur(12px);border-radius:var(--radius);box-shadow:var(--shadow);padding:20px;display:none;flex-direction:column;gap:12px;animation:fade .5s ease;}
@keyframes fade{from{opacity:0;transform:translateY(10px);}to{opacity:1;transform:translateY(0);}}
.card.show{display:flex;}
.card strong{font-size:1.1rem;color:var(--primary);}
.card .body{text-wrap:pretty;white-space:pre-wrap;line-height:1.5;}
footer{margin-top:auto;text-align:center;font-size:.8rem;color:#666;text-shadow:0 1px 2px rgba(255,255,255,.7);}
</style>
</head>
<body>

<h1>时间胶囊 · <span id="ym"></span></h1>

<!-- 月份导航 -->
<div class="header">
  <button class="btn-nav" id="prevM">‹</button>
  <button class="btn-nav" id="nextM">›</button>
</div>

<!-- 日历栅格 -->
<div id="cal" class="calendar"></div>

<!-- 寄语卡片 -->
<section id="card" class="card">
  <strong id="cDate"></strong>
  <div id="cBody" class="body"></div>
</section>

<!-- 引入固定寄语 -->
<script src="dateMessages.js"></script>

<script>
/* ============ 简明逻辑 ============ */
const $=s=>document.querySelector(s);
const cal=$('#cal'),ym=$('#ym'),card=$('#card'),cDate=$('#cDate'),cBody=$('#cBody');
const msgs=window.dateMessages||{};
let cur=new Date(),sel=null;

/* 格式化日期 */
const fmt=d=>d.toISOString().split('T')[0];

/* 渲染月历 */
function draw(){
  cal.innerHTML='';
  const y=cur.getFullYear(),m=cur.getMonth();ym.textContent=`${y} 年 ${m+1} 月`;
  '日一二三四五六'.split('').forEach(w=>cal.append(cell('weekday',w)));
  const first=new Date(y,m,1),off=first.getDay(),days=new Date(y,m+1,0).getDate();
  for(let i=0;i<off;i++)cal.append(cell('day disabled',''));
  for(let d=1;d<=days;d++){
    const date=new Date(y,m,d),key=fmt(date);
    const el=cell('day',d);
    key in msgs && el.classList.add('has');
    sel&&key===fmt(sel)&&el.classList.add('sel');
    el.onclick=()=>open(date,key);
    cal.append(el);
  }
}
/* 创建格子 */
function cell(cls,txt){
  const div=document.createElement('div');div.className=cls;div.textContent=txt;return div;
}
/* 打开寄语 */
function open(date,key){
  sel=date;draw();
  cDate.textContent=key;
  if(key in msgs){
    const m=msgs[key],sign=m.sign?`\n${m.sign}`:'';
    cBody.textContent=m.body+sign;
  }else cBody.textContent='今天还没有寄语，留一点期待吧～';
  card.classList.add('show');
}

/* 导航点击 */
$('#prevM').onclick=()=>{cur.setMonth(cur.getMonth()-1);draw();};
$('#nextM').onclick=()=>{cur.setMonth(cur.getMonth()+1);draw();};
draw();
</script>

<footer>完全离线可用 · 数据由 dateMessages.js 提供</footer>
</body>
</html>
